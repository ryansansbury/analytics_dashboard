[build]
builder = "nixpacks"

[build.nixpacks]
nixPkgs = ["nodejs_20", "python311"]
installCmd = "cd frontend && npm install && cd ../backend && pip install -r requirements.txt"
buildCmd = "cd frontend && npm run build && rm -rf ../backend/static && cp -r dist ../backend/static"

[deploy]
startCommand = "cd backend && gunicorn run:app --bind 0.0.0.0:$PORT --workers 2"
